import React,{useEffect,useState} from 'react'; import api from '../../api';
export default function AdminUsers(){ const [rows,setRows]=useState([]); const [edit,setEdit]=useState(null);
  const load=()=>api.get('/api/admin/users').then(r=>setRows(r.data)); useEffect(()=>{ load(); },[]);
  const save=async(u)=>{ await api.patch(`/api/admin/users/${u.id}`, { name:u.name, role:u.role }); setEdit(null); load(); };
  const del=async(id)=>{ if(confirm('Supprimer ?')){ await api.delete(`/api/admin/users/${id}`); load(); } };
  return (<div className="bg-white rounded-2xl p-6 shadow"><h2 className="text-2xl font-bold mb-4">Utilisateurs</h2><table className="w-full text-sm"><thead><tr className="text-left border-b"><th>Nom</th><th>Email</th><th>Rôle</th><th></th></tr></thead><tbody>{rows.map(u=>(<tr key={u.id} className="border-b last:border-0"><td>{edit===u.id ? <input className="border rounded px-2" defaultValue={u.name} onChange={e=>u.name=e.target.value}/> : u.name}</td><td className="text-gray-600">{u.email}</td><td>{edit===u.id ? (<select defaultValue={u.role} onChange={e=>u.role=e.target.value} className="border rounded px-2 py-1"><option value="user">user</option><option value="coach">coach</option><option value="admin">admin</option></select>) : <span className="px-2 py-1 rounded bg-slate-100">{u.role}</span>}</td><td className="text-right">{edit===u.id ? (<div className="flex gap-2 justify-end"><button onClick={()=>save(u)} className="px-3 py-1 rounded bg-indigo-600 text-white">Enregistrer</button><button onClick={()=>setEdit(null)} className="px-3 py-1 rounded border">Annuler</button></div>):(<div className="flex gap-2 justify-end"><button onClick={()=>setEdit(u.id)} className="px-3 py-1 rounded border">Éditer</button><button onClick={()=>del(u.id)} className="px-3 py-1 rounded border text-red-600">Supprimer</button></div>)}</td></tr>))}</tbody></table></div>) }